<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="DoroFill - Ïö¥ÌñâÏ†úÌïú ÏúÑÎ∞ò Ï†ÅÎ∞ú Î≥¥Í≥†ÏÑú ÏûëÏÑ±">
    <title>Ï†ÅÎ∞ú Î≥¥Í≥†ÏÑú - DoroFill</title>

    <!-- TailwindCSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- pdf-lib CDN -->
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>

    <!-- Google Fonts - Noto Sans KR -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/styles.css">

    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['Noto Sans KR', 'system-ui', '-apple-system', 'sans-serif'],
                    },
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#2563eb',
                            600: '#1d4ed8',
                            700: '#1e40af',
                            800: '#1e3a8a',
                            900: '#1e3a8a',
                        },
                        success: '#10b981',
                        warning: '#ef4444',
                    }
                }
            }
        }
    </script>
</head>

<body class="min-h-screen bg-gray-50 font-sans">
    <!-- Fixed Header -->
    <header class="header-fixed bg-white shadow-sm">
        <div class="container flex items-center justify-between h-full">
            <!-- Back Button -->
            <a href="index.html"
                class="flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors min-w-[44px] min-h-[44px] justify-center">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                <span class="text-sm hidden sm:inline">ÎèåÏïÑÍ∞ÄÍ∏∞</span>
            </a>

            <!-- Title -->
            <h1 class="text-lg font-bold text-gray-900">Ï†ÅÎ∞ú Î≥¥Í≥†ÏÑú ÏûëÏÑ±</h1>

            <!-- Save Button -->
            <button type="button" id="btn-save"
                class="flex items-center gap-1 px-3 py-2 text-sm font-medium text-primary-500 hover:bg-primary-50 rounded-lg transition-colors min-w-[44px] min-h-[44px] justify-center">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4">
                    </path>
                </svg>
                <span class="hidden sm:inline">Ï†ÄÏû•</span>
            </button>
        </div>
    </header>

    <!-- Main Content - Scrollable Area -->
    <main class="main-content">
        <div class="container">
            <form id="reportForm" novalidate>

                <!-- Section 1: Í∏∞Î≥∏ Ï†ïÎ≥¥ -->
                <section class="bg-white rounded-lg shadow-md p-4 mb-4 animate-fade-in">
                    <!-- Section Header -->
                    <h2
                        class="flex items-center gap-2 text-base font-semibold text-gray-900 mb-4 pb-3 border-b border-gray-100">
                        <span class="text-xl">üìç</span>
                        Í∏∞Î≥∏ Ï†ïÎ≥¥
                    </h2>

                    <!-- Ï†ÅÎ∞ú ÏùºÏãú -->
                    <div class="form-group">
                        <label for="reportDatetime" class="form-label form-label-required">
                            Ï†ÅÎ∞ú ÏùºÏãú
                        </label>
                        <input type="datetime-local" id="reportDatetime" name="reportDatetime" class="form-input w-full"
                            required>
                        <p class="text-xs text-gray-500 mt-1">ÏúÑÎ∞ò Ï∞®ÎüâÏùÑ Ï†ÅÎ∞úÌïú ÎÇ†ÏßúÏôÄ ÏãúÍ∞Ñ</p>
                    </div>

                    <!-- Ï†ÅÎ∞ú ÏúÑÏπò -->
                    <div class="form-group mb-0">
                        <label for="reportLocation" class="form-label form-label-required">
                            Ï†ÅÎ∞ú ÏúÑÏπò
                        </label>
                        <textarea id="reportLocation" name="reportLocation" class="form-input form-textarea w-full"
                            rows="2" placeholder="Íµ≠ÎèÑ 17Ìò∏ÏÑ† Ï∂©Î∂Å Ï≤≠Ï£ºÏãú ÏÑúÏõêÍµ¨ ÌòÑÎèÑÎ©¥ Ï£ΩÏïîÎ¶¨" required></textarea>
                        <p class="text-xs text-gray-500 mt-1">ÎèÑÎ°úÎ™Ö ÎòêÎäî ÏÉÅÏÑ∏ Ï£ºÏÜå ÏûÖÎ†•</p>
                    </div>
                </section>

                <!-- Section 2: Ïö¥Ï†ÑÏûê Ï†ïÎ≥¥ -->
                <section class="bg-white rounded-lg shadow-md p-4 mb-4 animate-fade-in">
                    <h2
                        class="flex items-center gap-2 text-base font-semibold text-gray-900 mb-4 pb-3 border-b border-gray-100">
                        <span class="text-xl">üë§</span>
                        Ïö¥Ï†ÑÏûê Ï†ïÎ≥¥
                    </h2>

                    <!-- ÏÑ±Î™Ö -->
                    <div class="form-group">
                        <label for="driverName" class="form-label form-label-required">
                            ÏÑ±Î™Ö
                        </label>
                        <input type="text" id="driverName" name="driverName" class="form-input w-full" placeholder="ÌôçÍ∏∏Îèô"
                            required>
                    </div>

                    <!-- Ï£ºÏÜå -->
                    <div class="form-group">
                        <label for="driverAddress" class="form-label form-label-required">
                            Ï£ºÏÜå
                        </label>
                        <input type="text" id="driverAddress" name="driverAddress" class="form-input w-full"
                            placeholder="ÏÑúÏö∏ÌäπÎ≥ÑÏãú Í∞ïÎÇ®Íµ¨ ÌÖåÌó§ÎûÄÎ°ú 123" required>
                    </div>

                    <!-- Ï†ÑÌôîÎ≤àÌò∏ Í∑∏Î£π -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <!-- ÏùºÎ∞òÏ†ÑÌôîÎ≤àÌò∏ -->
                        <div class="form-group mb-0">
                            <label for="phoneFixed" class="form-label">
                                ÏùºÎ∞òÏ†ÑÌôîÎ≤àÌò∏
                            </label>
                            <input type="tel" id="phoneFixed" name="phoneFixed" class="form-input w-full"
                                placeholder="043-123-4567" maxlength="13">
                        </div>

                        <!-- Ìú¥ÎåÄÏ†ÑÌôîÎ≤àÌò∏ -->
                        <div class="form-group mb-0">
                            <label for="phoneMobile" class="form-label form-label-required">
                                Ìú¥ÎåÄÏ†ÑÌôîÎ≤àÌò∏
                            </label>
                            <input type="tel" id="phoneMobile" name="phoneMobile" class="form-input w-full"
                                placeholder="010-1234-5678" maxlength="13" required>
                        </div>
                    </div>
                </section>

                <!-- Section 3: Ï∞®Îüâ Ï†ïÎ≥¥ -->
                <section class="bg-white rounded-lg shadow-md p-4 mb-4 animate-fade-in">
                    <h2
                        class="flex items-center gap-2 text-base font-semibold text-gray-900 mb-4 pb-3 border-b border-gray-100">
                        <span class="text-xl">üöõ</span>
                        Ï∞®Îüâ Ï†ïÎ≥¥
                    </h2>

                    <!-- Ï∞®Ï¢Ö & Îì±Î°ùÎ≤àÌò∏ -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <!-- Ï∞®Ï¢Ö -->
                        <div class="form-group">
                            <label for="vehicleType" class="form-label form-label-required">
                                Ï∞®Ï¢Ö
                            </label>
                            <input type="text" id="vehicleType" name="vehicleType" class="form-input w-full"
                                placeholder="5ÌÜ§ Ïπ¥Í≥†" required>
                        </div>

                        <!-- Îì±Î°ùÎ≤àÌò∏ -->
                        <div class="form-group">
                            <label for="plateNumber" class="form-label form-label-required">
                                Îì±Î°ùÎ≤àÌò∏
                            </label>
                            <input type="text" id="plateNumber" name="plateNumber" class="form-input w-full uppercase"
                                placeholder="81ÏÜå5678" required>
                        </div>
                    </div>

                    <!-- Ïö¥ÌñâÍ≤ΩÎ°ú -->
                    <div class="form-group">
                        <label for="route" class="form-label form-label-required">
                            Ïö¥ÌñâÍ≤ΩÎ°ú
                        </label>
                        <input type="text" id="route" name="route" class="form-input w-full" placeholder="Ï≤≠Ï£ºÎ∞©Î©¥ - Îã¨Í≥ÑÎ¶¨"
                            required>
                    </div>

                    <!-- Ï†ÅÏû¨Î¨º -->
                    <div class="form-group mb-0">
                        <label for="cargo" class="form-label form-label-required">
                            Ï†ÅÏû¨Î¨º
                        </label>
                        <input type="text" id="cargo" name="cargo" class="form-input w-full" placeholder="Î™©Ïû¨" required>
                    </div>
                </section>

                <!-- Section 4: ÏúÑÎ∞ò ÎÇ¥Ïö© (Ï∂îÌõÑ Íµ¨ÌòÑ) -->
                <section class="bg-white rounded-lg shadow-md p-4 mb-4">
                    <h2
                        class="flex items-center gap-2 text-base font-semibold text-gray-900 mb-4 pb-3 border-b border-gray-100">
                        <span class="text-xl">‚öñÔ∏è</span>
                        ÏúÑÎ∞ò ÎÇ¥Ïö©
                    </h2>
                    <p class="text-center text-gray-400 py-4 text-sm">
                        (Ï∂îÌõÑ Íµ¨ÌòÑ ÏòàÏ†ï)
                    </p>
                </section>

            </form>
        </div>
    </main>

    <!-- Fixed Footer - PDF Generate Button -->
    <footer class="footer-fixed bg-white">
        <div class="container">
            <button type="button" id="btn-generate-pdf" class="btn btn-primary btn-block">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
                    </path>
                </svg>
                PDF ÏÉùÏÑ±ÌïòÍ∏∞
            </button>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="js/app.js"></script>
    <script src="js/validator.js"></script>
    <script src="js/calculator.js"></script>
    <script src="js/pdf-handler.js"></script>

    <!-- Page Specific Script -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // === Phone Number Auto-Hyphen Formatter ===
            function formatPhoneNumber(value) {
                // Remove all non-digits
                const numbers = value.replace(/\D/g, '');

                // Format based on length
                if (numbers.length <= 3) {
                    return numbers;
                } else if (numbers.length <= 6) {
                    return `${numbers.slice(0, 3)}-${numbers.slice(3)}`;
                } else if (numbers.length <= 10) {
                    // 010-123-4567 or 02-1234-5678
                    if (numbers.startsWith('02')) {
                        return `${numbers.slice(0, 2)}-${numbers.slice(2, 6)}-${numbers.slice(6)}`;
                    }
                    return `${numbers.slice(0, 3)}-${numbers.slice(3, 6)}-${numbers.slice(6)}`;
                } else {
                    // 010-1234-5678
                    if (numbers.startsWith('02')) {
                        return `${numbers.slice(0, 2)}-${numbers.slice(2, 6)}-${numbers.slice(6, 10)}`;
                    }
                    return `${numbers.slice(0, 3)}-${numbers.slice(3, 7)}-${numbers.slice(7, 11)}`;
                }
            }

            // Apply phone formatter to phone inputs
            const phoneInputs = document.querySelectorAll('input[type="tel"]');
            phoneInputs.forEach(input => {
                input.addEventListener('input', (e) => {
                    e.target.value = formatPhoneNumber(e.target.value);
                });
            });

            // === Plate Number Uppercase Converter ===
            const plateInput = document.getElementById('plateNumber');
            if (plateInput) {
                plateInput.addEventListener('input', (e) => {
                    e.target.value = e.target.value.toUpperCase();
                });
            }

            // === Set default datetime to current ===
            const datetimeInput = document.getElementById('reportDatetime');
            if (datetimeInput && !datetimeInput.value) {
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                datetimeInput.value = `${year}-${month}-${day}T${hours}:${minutes}`;
            }

            // === Form Fields List ===
            const formFields = [
                'reportDatetime', 'reportLocation',
                'driverName', 'driverAddress', 'phoneFixed', 'phoneMobile',
                'vehicleType', 'plateNumber', 'route', 'cargo'
            ];

            // === Save Button Handler ===
            const saveBtn = document.getElementById('btn-save');
            if (saveBtn) {
                saveBtn.addEventListener('click', () => {
                    const formData = {};
                    formFields.forEach(field => {
                        const el = document.getElementById(field);
                        if (el) formData[field] = el.value;
                    });
                    saveToStorage('report_draft', formData);
                    showToast('ÏûÑÏãú Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§', 'success');
                });
            }

            // === Load Saved Draft ===
            const savedDraft = loadFromStorage('report_draft');
            if (savedDraft) {
                formFields.forEach(field => {
                    const el = document.getElementById(field);
                    if (el && savedDraft[field]) {
                        el.value = savedDraft[field];
                    }
                });
            }

            // === PDF Generate Button Handler ===
            const pdfBtn = document.getElementById('btn-generate-pdf');
            if (pdfBtn) {
                pdfBtn.addEventListener('click', async () => {
                    // Validate required fields
                    const requiredFields = [
                        'reportDatetime', 'reportLocation',
                        'driverName', 'driverAddress', 'phoneMobile',
                        'vehicleType', 'plateNumber', 'route', 'cargo'
                    ];

                    let isValid = true;
                    requiredFields.forEach(field => {
                        const el = document.getElementById(field);
                        if (el && !el.value.trim()) {
                            el.classList.add('form-input-error');
                            isValid = false;
                        } else if (el) {
                            el.classList.remove('form-input-error');
                        }
                    });

                    if (!isValid) {
                        showToast('ÌïÑÏàò Ìï≠Î™©ÏùÑ Î™®Îëê ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî', 'warning');
                        return;
                    }

                    showToast('PDF ÏÉùÏÑ± Í∏∞Îä•ÏùÄ Ï∂îÌõÑ Íµ¨ÌòÑ ÏòàÏ†ïÏûÖÎãàÎã§', 'info');
                });
            }
        });
    </script>
</body>

</html>