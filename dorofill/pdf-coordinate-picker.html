<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF ì¢Œí‘œ ì¸¡ì •ê¸° - DoroFill</title>

    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1e293b;
            color: #e2e8f0;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header h1 {
            font-size: 1.25rem;
        }

        .controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #2563eb;
            color: white;
        }

        .btn-primary:hover {
            background: #1d4ed8;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-outline {
            background: transparent;
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .main {
            display: flex;
            height: calc(100vh - 60px);
        }

        .pdf-container {
            flex: 1;
            overflow: auto;
            padding: 1rem;
            background: #334155;
            position: relative;
        }

        .pdf-image-wrapper {
            position: relative;
            display: inline-block;
            cursor: crosshair;
        }

        .pdf-image {
            max-width: 100%;
            height: auto;
            border: 2px solid #475569;
            border-radius: 8px;
        }

        .marker {
            position: absolute;
            width: 12px;
            height: 12px;
            background: #ef4444;
            border: 2px solid white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
            z-index: 10;
        }

        .marker-label {
            position: absolute;
            left: 16px;
            top: -8px;
            background: #ef4444;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            white-space: nowrap;
        }

        .sidebar {
            width: 400px;
            background: #0f172a;
            padding: 1rem;
            overflow-y: auto;
            border-left: 1px solid #334155;
        }

        .sidebar h2 {
            font-size: 1rem;
            margin-bottom: 1rem;
            color: #60a5fa;
        }

        .coord-list {
            background: #1e293b;
            border-radius: 8px;
            padding: 0.5rem;
            margin-bottom: 1rem;
            max-height: 300px;
            overflow-y: auto;
        }

        .coord-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem;
            border-bottom: 1px solid #334155;
            font-size: 0.875rem;
        }

        .coord-item:last-child {
            border-bottom: none;
        }

        .coord-item .name {
            color: #34d399;
            font-weight: 600;
        }

        .coord-item .coords {
            color: #fbbf24;
            font-family: monospace;
        }

        .coord-item .delete {
            color: #ef4444;
            cursor: pointer;
            padding: 4px;
        }

        .input-group {
            margin-bottom: 1rem;
        }

        .input-group label {
            display: block;
            font-size: 0.75rem;
            color: #94a3b8;
            margin-bottom: 0.25rem;
        }

        .input-group input,
        .input-group select {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #475569;
            border-radius: 6px;
            background: #1e293b;
            color: white;
            font-size: 0.875rem;
        }

        .output-box {
            background: #1e293b;
            border-radius: 8px;
            padding: 1rem;
            font-family: 'Consolas', monospace;
            font-size: 0.75rem;
            line-height: 1.5;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #334155;
        }

        .info-bar {
            background: #334155;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            font-size: 0.75rem;
        }

        .info-bar span {
            margin-right: 1.5rem;
        }

        .current-pos {
            color: #60a5fa;
        }

        .page-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .page-tab {
            padding: 0.5rem 1rem;
            background: #334155;
            border: none;
            border-radius: 6px;
            color: #94a3b8;
            cursor: pointer;
            transition: all 0.2s;
        }

        .page-tab.active {
            background: #2563eb;
            color: white;
        }

        .instructions {
            background: #1e3a5f;
            border-left: 3px solid #3b82f6;
            padding: 0.75rem;
            margin-bottom: 1rem;
            font-size: 0.75rem;
            border-radius: 0 8px 8px 0;
        }
    </style>
</head>

<body>
    <div class="header">
        <h1>ğŸ“ PDF ì¢Œí‘œ ì¸¡ì •ê¸°</h1>
        <div class="controls">
            <input type="file" id="imageInput" accept="image/*" style="display:none">
            <button class="btn btn-outline" onclick="document.getElementById('imageInput').click()">
                ğŸ–¼ï¸ ì´ë¯¸ì§€ ë¶ˆëŸ¬ì˜¤ê¸°
            </button>
            <button class="btn btn-success" onclick="copyOutput()">
                ğŸ“‹ ì¢Œí‘œ ë³µì‚¬
            </button>
            <button class="btn btn-primary" onclick="clearAllMarkers()">
                ğŸ—‘ï¸ ì´ˆê¸°í™”
            </button>
        </div>
    </div>

    <div class="main">
        <div class="pdf-container" id="pdfContainer">
            <div class="instructions">
                <strong>ğŸ’¡ ì‚¬ìš© ë°©ë²•:</strong><br>
                1. PDFë¥¼ ì´ë¯¸ì§€(PNG/JPG)ë¡œ ì €ì¥í•˜ê±°ë‚˜ í™”ë©´ ìº¡ì²˜<br>
                2. "ì´ë¯¸ì§€ ë¶ˆëŸ¬ì˜¤ê¸°" í´ë¦­í•˜ì—¬ ì´ë¯¸ì§€ ì„ íƒ<br>
                3. ì´ë¯¸ì§€ ìœ„ì—ì„œ ì›í•˜ëŠ” ìœ„ì¹˜ í´ë¦­í•˜ì—¬ ì¢Œí‘œ ì¸¡ì •<br>
                4. í•„ë“œ ì´ë¦„ ì…ë ¥ í›„ "ì¢Œí‘œ ë³µì‚¬"ë¡œ ì½”ë“œ ë³µì‚¬
            </div>

            <div class="page-tabs">
                <button class="page-tab active" data-page="1">í˜ì´ì§€ 1 (ì ë°œ ë³´ê³ ì„œ)</button>
                <button class="page-tab" data-page="2">í˜ì´ì§€ 2 (ì§„ìˆ ì„œ)</button>
            </div>

            <div class="pdf-image-wrapper" id="imageWrapper">
                <img id="pdfImage" class="pdf-image" src="" alt="PDF ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¤ì„¸ìš”"
                    style="min-height: 400px; background: #1e293b; display: flex; align-items: center; justify-content: center;">
            </div>
        </div>

        <div class="sidebar">
            <div class="info-bar">
                <span>í˜„ì¬ í˜ì´ì§€: <strong id="currentPage">1</strong></span>
                <span>ë§ˆìš°ìŠ¤ ìœ„ì¹˜: <span class="current-pos" id="mousePos">-</span></span>
            </div>

            <div class="input-group">
                <label>í•„ë“œ ì´ë¦„ (ë‹¤ìŒ í´ë¦­ì— ì ìš©ë¨)</label>
                <input type="text" id="fieldName" placeholder="ì˜ˆ: reportDatetime">
            </div>

            <div class="input-group">
                <label>í°íŠ¸ í¬ê¸°</label>
                <select id="fontSize">
                    <option value="9">9pt (ì‘ì€ ê¸€ì”¨)</option>
                    <option value="10">10pt</option>
                    <option value="11" selected>11pt (ê¸°ë³¸)</option>
                    <option value="12">12pt</option>
                    <option value="14">14pt (ì¤‘ê°„ì œëª©)</option>
                    <option value="16">16pt</option>
                    <option value="18">18pt (ì œëª©)</option>
                </select>
            </div>

            <h2>ğŸ“ ì €ì¥ëœ ì¢Œí‘œ (<span id="markerCount">0</span>ê°œ)</h2>
            <div class="coord-list" id="coordList">
                <div style="color: #64748b; text-align: center; padding: 1rem;">
                    ì´ë¯¸ì§€ë¥¼ í´ë¦­í•˜ì—¬ ì¢Œí‘œë¥¼ ì¶”ê°€í•˜ì„¸ìš”
                </div>
            </div>

            <h2>ğŸ“‹ PDF_COORDINATES ì½”ë“œ</h2>
            <div class="output-box" id="outputCode">
                // ì¢Œí‘œë¥¼ ì¸¡ì •í•˜ë©´ ì—¬ê¸°ì— ì½”ë“œê°€ ìƒì„±ë©ë‹ˆë‹¤
                const PDF_COORDINATES = {
                page1: {
                // í´ë¦­í•˜ì—¬ ì¢Œí‘œ ì¶”ê°€
                },
                page2: {
                // í´ë¦­í•˜ì—¬ ì¢Œí‘œ ì¶”ê°€
                }
                };
            </div>
        </div>
    </div>

    <script>
        // ìƒíƒœ ê´€ë¦¬
        let currentPage = 1;
        let markers = {
            page1: [],
            page2: []
        };

        // PDF í¬ê¸° (í¬ì¸íŠ¸ ë‹¨ìœ„)
        const PDF_SIZE = {
            width: 595.00,
            height: 841.00
        };

        // ì´ë¯¸ì§€ í¬ê¸° (ë Œë”ë§ëœ í¬ê¸°)
        let imageSize = { width: 0, height: 0 };

        // DOM ìš”ì†Œ
        const imageWrapper = document.getElementById('imageWrapper');
        const pdfImage = document.getElementById('pdfImage');
        const fieldNameInput = document.getElementById('fieldName');
        const fontSizeSelect = document.getElementById('fontSize');
        const coordList = document.getElementById('coordList');
        const outputCode = document.getElementById('outputCode');
        const markerCountSpan = document.getElementById('markerCount');
        const mousePosSpan = document.getElementById('mousePos');
        const currentPageSpan = document.getElementById('currentPage');

        // ì´ë¯¸ì§€ ë¶ˆëŸ¬ì˜¤ê¸°
        document.getElementById('imageInput').addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (event) => {
                pdfImage.src = event.target.result;
                pdfImage.style.minHeight = 'auto';

                pdfImage.onload = () => {
                    imageSize.width = pdfImage.naturalWidth;
                    imageSize.height = pdfImage.naturalHeight;
                    console.log(`ì´ë¯¸ì§€ ë¡œë“œ: ${imageSize.width} x ${imageSize.height}`);
                };
            };
            reader.readAsDataURL(file);
        });

        // í˜ì´ì§€ íƒ­ ì „í™˜
        document.querySelectorAll('.page-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.page-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                currentPage = parseInt(tab.dataset.page);
                currentPageSpan.textContent = currentPage;
                updateDisplay();
            });
        });

        // ë§ˆìš°ìŠ¤ ìœ„ì¹˜ ì¶”ì 
        imageWrapper.addEventListener('mousemove', (e) => {
            if (!pdfImage.naturalWidth) return;

            const rect = pdfImage.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            // PDF ì¢Œí‘œë¡œ ë³€í™˜ (PDFëŠ” ì¢Œí•˜ë‹¨ì´ ì›ì , yì¶• ë°˜ì „)
            const pdfX = (x / pdfImage.clientWidth) * PDF_SIZE.width;
            const pdfY = PDF_SIZE.height - (y / pdfImage.clientHeight) * PDF_SIZE.height;

            mousePosSpan.textContent = `x: ${pdfX.toFixed(1)}, y: ${pdfY.toFixed(1)}`;
        });

        // í´ë¦­í•˜ì—¬ ì¢Œí‘œ ì €ì¥
        imageWrapper.addEventListener('click', (e) => {
            if (!pdfImage.naturalWidth || e.target === pdfImage && !pdfImage.src) return;

            const rect = pdfImage.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            // PDF ì¢Œí‘œë¡œ ë³€í™˜
            const pdfX = (x / pdfImage.clientWidth) * PDF_SIZE.width;
            const pdfY = PDF_SIZE.height - (y / pdfImage.clientHeight) * PDF_SIZE.height;

            // í•„ë“œ ì´ë¦„
            let fieldName = fieldNameInput.value.trim();
            if (!fieldName) {
                fieldName = `field${markers[`page${currentPage}`].length + 1}`;
            }

            // ë§ˆì»¤ ì¶”ê°€
            const marker = {
                name: fieldName,
                x: pdfX,
                y: pdfY,
                size: parseInt(fontSizeSelect.value),
                screenX: x,
                screenY: y
            };

            markers[`page${currentPage}`].push(marker);

            // ë‹¤ìŒ í•„ë“œ ì´ë¦„ ìë™ ì¦ê°€
            const match = fieldName.match(/^(.+?)(\d+)$/);
            if (match) {
                fieldNameInput.value = match[1] + (parseInt(match[2]) + 1);
            } else {
                fieldNameInput.value = '';
            }

            updateDisplay();
        });

        // í™”ë©´ ì—…ë°ì´íŠ¸
        function updateDisplay() {
            const pageMarkers = markers[`page${currentPage}`];

            // ë§ˆì»¤ í‘œì‹œ
            document.querySelectorAll('.marker').forEach(m => m.remove());

            pageMarkers.forEach((marker, index) => {
                const markerEl = document.createElement('div');
                markerEl.className = 'marker';
                markerEl.style.left = marker.screenX + 'px';
                markerEl.style.top = marker.screenY + 'px';

                const label = document.createElement('span');
                label.className = 'marker-label';
                label.textContent = marker.name;
                markerEl.appendChild(label);

                imageWrapper.appendChild(markerEl);
            });

            // ì¢Œí‘œ ëª©ë¡ ì—…ë°ì´íŠ¸
            if (pageMarkers.length === 0) {
                coordList.innerHTML = '<div style="color: #64748b; text-align: center; padding: 1rem;">ì´ë¯¸ì§€ë¥¼ í´ë¦­í•˜ì—¬ ì¢Œí‘œë¥¼ ì¶”ê°€í•˜ì„¸ìš”</div>';
            } else {
                coordList.innerHTML = pageMarkers.map((m, i) => `
                    <div class="coord-item">
                        <span class="name">${m.name}</span>
                        <span class="coords">x:${m.x.toFixed(1)}, y:${m.y.toFixed(1)}</span>
                        <span class="delete" onclick="deleteMarker(${i})">âœ•</span>
                    </div>
                `).join('');
            }

            // ë§ˆì»¤ ê°œìˆ˜
            const totalCount = markers.page1.length + markers.page2.length;
            markerCountSpan.textContent = totalCount;

            // ì½”ë“œ ìƒì„±
            generateCode();
        }

        // ë§ˆì»¤ ì‚­ì œ
        function deleteMarker(index) {
            markers[`page${currentPage}`].splice(index, 1);
            updateDisplay();
        }

        // ëª¨ë“  ë§ˆì»¤ ì‚­ì œ
        function clearAllMarkers() {
            if (confirm('ëª¨ë“  ì¢Œí‘œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                markers = { page1: [], page2: [] };
                updateDisplay();
            }
        }

        // ì½”ë“œ ìƒì„±
        function generateCode() {
            let code = `const PDF_COORDINATES = {\n`;

            code += `    // í˜ì´ì§€ 1: ì ë°œ ë³´ê³ ì„œ\n`;
            code += `    page1: {\n`;
            markers.page1.forEach(m => {
                code += `        '${m.name}': { x: ${m.x.toFixed(2)}, y: ${m.y.toFixed(2)}, size: ${m.size} },\n`;
            });
            code += `    },\n\n`;

            code += `    // í˜ì´ì§€ 2: ì§„ìˆ ì„œ\n`;
            code += `    page2: {\n`;
            markers.page2.forEach(m => {
                code += `        '${m.name}': { x: ${m.x.toFixed(2)}, y: ${m.y.toFixed(2)}, size: ${m.size} },\n`;
            });
            code += `    }\n`;

            code += `};\n`;

            outputCode.textContent = code;
        }

        // ë³µì‚¬
        function copyOutput() {
            navigator.clipboard.writeText(outputCode.textContent).then(() => {
                alert('ì¢Œí‘œ ì½”ë“œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }

        // ì´ˆê¸°í™”
        generateCode();
    </script>
</body>

</html>